---
# Deploy in HOME (non /var/www). Pipeline deve usare questo appspec senza override della destination.
version: 0.0
os: linux
files:
  - source: /
    destination: /home/ec2-user/revenue.magellano.ai

file_exists_behavior: OVERWRITE

# Proprietario ec2-user (sul server Docker non esiste apache)
permissions:
  - object: /home/ec2-user/revenue.magellano.ai
    owner: ec2-user
    group: ec2-user

# Timeout AfterInstall 600s come deploy_exemple: evita deploy "in progress" a oltranza; se supera 10 min CodeDeploy segna Failed.
hooks:
  BeforeInstall:
    - location: deploy/beforeInstall.sh
      timeout: 60
  AfterInstall:
    - location: deploy/afterInstall.sh
      timeout: 600
